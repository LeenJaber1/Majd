[gd_scene load_steps=4 format=3 uid="uid://dryyivym76t7a"]

[ext_resource type="Texture2D" path="res://assets/puzzles/petraPuzzleAssets/keyCypher.png" id="2_7vo68"]

[sub_resource type="GDScript" id="GDScript_iq7in"]
script/source = "extends TextureButton

var number

signal tile_pressed
signal slide_completed

# Update the number of the tile
func set_text(new_number):
	number = new_number
	$Number/Label.text = str(number)

# Update the background image of the tile
func set_sprite(new_frame, size, tile_size):
	var sprite = $Sprite

	update_size(size, tile_size)

	sprite.set_hframes(size)
	sprite.set_vframes(size)
	sprite.set_frame(new_frame)

# scale to the new tile_size
func update_size(size, tile_size):
	var new_size = Vector2(tile_size, tile_size)
	set_size(new_size)
	$Number.set_size(new_size)
	$Number/ColorRect.set_size(new_size)
	$Number/Label.set_size(new_size)
	$Panel.set_size(new_size)

	var to_scale = size * (new_size / $Sprite.texture.get_size())
	$Sprite.set_scale(to_scale)

# Update the entire background image
func set_sprite_texture(texture):
	$Sprite.set_texture(texture)

# Slide the tile to a new position
func slide_to(new_position, duration):
	var tween = create_tween()
	add_child(tween)
	tween.interpolate_property(self, \"rect_position\", null, new_p)osition, duration, Tween.TRANS_QUART, Tween.EASE_OUT)
	tween.start()

# Hide / Show the number of the tile
func set_number_visible(state):
	$Number.visible = state

# Tile is pressed
func _on_pressed():
	emit_signal(\"tile_pressed\", number)

# Tile has finished sliding
func _on_Tween_tween_completed(_object, _key):
	emit_signal(\"slide_completed\", number)




func _on_slide_completed():
	pass # Replace with function body.
"

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_6n21i"]
draw_center = false
border_width_left = 1
border_width_top = 1
border_width_right = 1
border_width_bottom = 1
border_color = Color(0.266667, 0.145098, 0.0352941, 1)
border_blend = true

[node name="Tile" type="TextureButton"]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
scale = Vector2(0.977189, 1.081)
script = SubResource("GDScript_iq7in")

[node name="KeyCypher" type="Sprite2D" parent="."]
position = Vector2(48, 48)
scale = Vector2(0.334, 0.334)
texture = ExtResource("2_7vo68")
hframes = 4
vframes = 4

[node name="number" type="Control" parent="."]
anchors_preset = 0
offset_right = 40.0
offset_bottom = 40.0
scale = Vector2(2.3173, 2.32785)

[node name="ColorRect" type="ColorRect" parent="number"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
color = Color(0.152941, 0.160784, 0.160784, 0.568627)

[node name="Label" type="Label" parent="number"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
text = "1"
horizontal_alignment = 1
vertical_alignment = 1

[node name="Panel" type="Panel" parent="."]
layout_mode = 0
offset_right = 40.0
offset_bottom = 40.0
scale = Vector2(2.32585, 2.30768)
theme_override_styles/panel = SubResource("StyleBoxFlat_6n21i")

[connection signal="pressed" from="." to="." method="_on_pressed"]
